<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<script src="vue.js"></script>
	<script src="vue-resource@1.3.4"></script>
	<style>
		.active{
			background-color: red;
		}
	</style>
</head>
<body>
	<div id="app">
		<form :action="type == 'song' ? 'song.html' : 'mv.html' ">
			<select name="type" v-model:type = "type" @blur = "choseType(),search()" id="select">
				<option value="song" selected>song</option>
				<option value="mv">mv</option>
			</select>

			<input type="text" name="name" v-model="name" v-on:keydown = "search()" placeholder="请输入歌名并选择mv或者MP3">
			<input type="hidden" name="id" v-model="id" >
			<input :disabled = "name == ''? true : false" :class="{active : this.name != '' }" type="submit" value="提交" @click="search()">
		</form>
	</div>

	<script>
		new Vue({
			el: '#app',
			data:{
				id: 0,
				type: 'song',
				mv: null,
				mp3: null,
				name: ''
			},
			methods: {
				search: function () {
					// if(this.name == ''){ return };
					if( this.name == ''){ return false};
					this.$http.get('https://api.imjad.cn/cloudmusic/?type=search&s='+this.name+'&t='+new Date()).then((response) => {
						this.mp3 = response.body;
						this.id = this.mp3.result.songs[0].id;
						console.log(this.id)
					});
					this.$http.get('https://api.imjad.cn/cloudmusic/?type=search&search_type=1004&s='+this.name+'&t='+new Date()).then((response) => {
						this.mv = response.body;
					})
				},
				choseType: function(){
					console.log(this.type)
					if(this.name == ''){ return };
					this.type = document.getElementById('select').value;
					if(this.type == 'song'){
						this.id = this.mp3.result.songs[0].id;
					}
					if(this.type == 'mv'){
						this.id = this.mv.result.mvs[0].id;
					}
				},
			},
		})
	</script>
</body>
</html>